<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Shortest Path Optimization in R</title>

  <meta property="description" itemprop="description" content="In this post we will walk through how to make least cost decisions using network flows shortest path algorithm."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2022-07-09"/>
  <meta property="article:created" itemprop="dateCreated" content="2022-07-09"/>
  <meta name="article:author" content="Blake Conrad"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Shortest Path Optimization in R"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="In this post we will walk through how to make least cost decisions using network flows shortest path algorithm."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Shortest Path Optimization in R"/>
  <meta property="twitter:description" content="In this post we will walk through how to make least cost decisions using network flows shortest path algorithm."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","categories","description","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Shortest Path Optimization in R"]},{"type":"character","attributes":{},"value":["network flows","linear programming"]},{"type":"character","attributes":{},"value":["In this post we will walk through how to make least cost decisions using network flows shortest path algorithm.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Blake Conrad"]},{"type":"character","attributes":{},"value":["https://github.com/conradbm"]}]}]},{"type":"character","attributes":{},"value":["2022-07-09"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","toc_float"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["shortest-path-optimization-in-r_files/anchor-4.2.2/anchor.min.js","shortest-path-optimization-in-r_files/bowser-1.9.3/bowser.min.js","shortest-path-optimization-in-r_files/distill-2.2.21/template.v2.js","shortest-path-optimization-in-r_files/figure-html5/final_plot-1.png","shortest-path-optimization-in-r_files/figure-html5/viz_network-1.png","shortest-path-optimization-in-r_files/header-attrs-2.11/header-attrs.js","shortest-path-optimization-in-r_files/htmlwidgets-1.5.4/htmlwidgets.js","shortest-path-optimization-in-r_files/jquery-3.6.0/jquery-3.6.0.js","shortest-path-optimization-in-r_files/jquery-3.6.0/jquery-3.6.0.min.js","shortest-path-optimization-in-r_files/jquery-3.6.0/jquery-3.6.0.min.map","shortest-path-optimization-in-r_files/popper-2.6.0/popper.min.js","shortest-path-optimization-in-r_files/tippy-6.2.7/tippy-bundle.umd.min.js","shortest-path-optimization-in-r_files/tippy-6.2.7/tippy-light-border.css","shortest-path-optimization-in-r_files/tippy-6.2.7/tippy.css","shortest-path-optimization-in-r_files/tippy-6.2.7/tippy.umd.min.js","shortest-path-optimization-in-r_files/vis-9.1.0/add_css.txt","shortest-path-optimization-in-r_files/vis-9.1.0/img/network/acceptDeleteIcon.png","shortest-path-optimization-in-r_files/vis-9.1.0/img/network/addNodeIcon.png","shortest-path-optimization-in-r_files/vis-9.1.0/img/network/backIcon.png","shortest-path-optimization-in-r_files/vis-9.1.0/img/network/connectIcon.png","shortest-path-optimization-in-r_files/vis-9.1.0/img/network/cross.png","shortest-path-optimization-in-r_files/vis-9.1.0/img/network/cross2.png","shortest-path-optimization-in-r_files/vis-9.1.0/img/network/deleteIcon.png","shortest-path-optimization-in-r_files/vis-9.1.0/img/network/downArrow.png","shortest-path-optimization-in-r_files/vis-9.1.0/img/network/editIcon.png","shortest-path-optimization-in-r_files/vis-9.1.0/img/network/leftArrow.png","shortest-path-optimization-in-r_files/vis-9.1.0/img/network/minus.png","shortest-path-optimization-in-r_files/vis-9.1.0/img/network/plus.png","shortest-path-optimization-in-r_files/vis-9.1.0/img/network/rightArrow.png","shortest-path-optimization-in-r_files/vis-9.1.0/img/network/upArrow.png","shortest-path-optimization-in-r_files/vis-9.1.0/img/network/zoomExtends.png","shortest-path-optimization-in-r_files/vis-9.1.0/vis-network.min.css","shortest-path-optimization-in-r_files/vis-9.1.0/vis-network.min.js","shortest-path-optimization-in-r_files/visNetwork-binding-2.1.0/visNetwork.js","shortest-path-optimization-in-r_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        if ($(this).children()[0].nodeName == "D-FOOTNOTE") {
          var fn = $(this).children()[0]
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="shortest-path-optimization-in-r_files/header-attrs-2.11/header-attrs.js"></script>
  <script src="shortest-path-optimization-in-r_files/htmlwidgets-1.5.4/htmlwidgets.js"></script>
  <link href="shortest-path-optimization-in-r_files/vis-9.1.0/vis-network.min.css" rel="stylesheet" />
  <script src="shortest-path-optimization-in-r_files/vis-9.1.0/vis-network.min.js"></script>
  <script src="shortest-path-optimization-in-r_files/visNetwork-binding-2.1.0/visNetwork.js"></script>
  <script src="shortest-path-optimization-in-r_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="shortest-path-optimization-in-r_files/popper-2.6.0/popper.min.js"></script>
  <link href="shortest-path-optimization-in-r_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="shortest-path-optimization-in-r_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="shortest-path-optimization-in-r_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="shortest-path-optimization-in-r_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="shortest-path-optimization-in-r_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="shortest-path-optimization-in-r_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="shortest-path-optimization-in-r_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Shortest Path Optimization in R","description":"In this post we will walk through how to make least cost decisions using network flows shortest path algorithm.","authors":[{"author":"Blake Conrad","authorURL":"https://github.com/conradbm","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2022-07-09T00:00:00.000-04:00","citationText":"Conrad, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Shortest Path Optimization in R</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt-tag">network flows</div>
<div class="dt-tag">linear programming</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>In this post we will walk through how to make least cost decisions
using network flows shortest path algorithm.</p></p>
</div>

<div class="d-byline">
  Blake Conrad <a href="https://github.com/conradbm"
class="uri">https://github.com/conradbm</a> 
  
<br/>2022-07-09
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#vehicle-replacement-using-shortest-path">Vehicle
Replacement Using Shortest Path</a>
<ul>
<li><a href="#problem-setup">Problem Setup</a></li>
<li><a href="#problem-data">Problem Data</a>
<ul>
<li><a href="#new-car-cost">New Car Cost</a></li>
<li><a href="#maintenance-costs">Maintenance Costs</a></li>
<li><a href="#trade-in-revenues">Trade-in Revenues</a></li>
<li><a href="#cost-matrix">Cost Matrix</a></li>
</ul></li>
<li><a href="#solving-the-problem">Solving the Problem</a>
<ul>
<li><a href="#visualizing-the-network">Visualizing the network</a></li>
<li><a href="#shortest-path-solution">Shortest Path Solution</a></li>
<li><a href="#shortest-path-analysis">Shortest Path Analysis</a></li>
</ul></li>
</ul></li>
<li><a href="#references">References</a></li>
</ul>
</nav>
</div>
<h1 id="vehicle-replacement-using-shortest-path">Vehicle Replacement
Using Shortest Path</h1>
<p>A common problem we often face in the world is to find the shortest
path between two points. Whether it is on the road, or how to obtain an
object in in our intellectual trajectory, we are always seeking to
optimize.</p>
<p>In network flows one common problem is to find the
<code>s-t shortest path</code>. The problem formulation is as
follows.</p>
<p>Given some net of nodes, and two particular nodes <code>s</code> and
<code>t</code> that are not the same, find the shortest distance through
the edges connecting them. The mathematical formulation is below. <span
class="math display">\[ N \in \{n_1, n_2, .., n_D\} \]</span> <span
class="math display">\[ E = \{N \times N\} = \{e_{ij} \in \Re^+ |
\:\:\forall i,j \in N \} \]</span> <span class="math display">\[ s,t \in
N : s\neq t\]</span></p>
<h2 id="problem-setup">Problem Setup</h2>
<p>We all have to drive cars at some point in our adult lives (well,
most of us). With this comes the question of <em>investment
decisions</em> if I am allowed to call it that. Which car should we buy?
How long should we keep it? Is it more prudent to keep paying
maintenance, repairs, and damages, or just get a new ride?</p>
<p>We would like to know what is the best decision to make over the next
5 years for our vehicle needs. So we take this problem and model it as
an optimization problem using the famous
<code>shortest paths algorithm</code>.</p>
<p>So with our problem the decision space is pretty straight
forward:</p>
<ol type="1">
<li><p>Each year we can choose to keep our vehicle, or</p></li>
<li><p>Trade it in</p></li>
</ol>
<p>However, every year we choose to keep our vehicle, we must pay
maintenance costs for it. So every year we keep it, there is a
cumulative maintenance cost. Once we trade-in we offset the cost of the
new car with the trade in value, and pay much less maintenance on the
new ride. Let’s take a look at the problem data.</p>
<h2 id="problem-data">Problem Data</h2>
<p>We know the cost every year of a new vehicle is assumed as
<code>$12,000</code> for simplicity. Further, we have some records of
what maintenance costs and trade-in values will be.</p>
<h3 id="new-car-cost">New Car Cost</h3>
<p>The new car cost is assumed constant every year. An interesting
homework assignment would be to make this <code>stochastic</code> and
change over time. This is much more suitable to the real world, but for
this example will remain constant.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>NEW_CAR_COST</span> <span class='op'>&lt;-</span> <span class='fl'>12000</span></span>
<span><span class='va'>NEW_CAR_COST</span></span></code></pre>
</div>
<pre><code>[1] 12000</code></pre>
</div>
<h3 id="maintenance-costs">Maintenance Costs</h3>
<p>The maintenance costs are for 4 years. Each year you keep the car,
you will pay more on maintenance.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>M</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>Year <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>)</span>, Maintenance_cost <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2000</span>, <span class='fl'>4000</span>, <span class='fl'>5000</span>, <span class='fl'>9000</span>, <span class='fl'>12000</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>M_vec</span> <span class='op'>&lt;-</span> <span class='va'>M</span> <span class='op'>%&gt;%</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>Maintenance_cost</span><span class='op'>)</span></span>
<span><span class='va'>M</span></span></code></pre>
</div>
<pre><code>  Year Maintenance_cost
1    0             2000
2    1             4000
3    2             5000
4    3             9000
5    4            12000</code></pre>
</div>
<h3 id="trade-in-revenues">Trade-in Revenues</h3>
<p>The trade-in price is similar to maintenance. Each year you keep the
vehicle, it will depreciate. So to account for this we have a decreasing
trade-in value.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='cn'>T</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>Year <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span>, Trade_in_price <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>7000</span>, <span class='fl'>6000</span>, <span class='fl'>2000</span>, <span class='fl'>1000</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>T_vec</span> <span class='op'>&lt;-</span> <span class='cn'>T</span> <span class='op'>%&gt;%</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>Trade_in_price</span><span class='op'>)</span></span>
<span><span class='cn'>T</span></span></code></pre>
</div>
<pre><code>  Year Trade_in_price
1    1           7000
2    2           6000
3    3           2000
4    4           1000
5    5              0</code></pre>
</div>
<h3 id="cost-matrix">Cost Matrix</h3>
<p>Since we know the costs will be cumulative, so we know what each
years will be. The cost matrix will be for the number of years the car
is kept to accumulate costs from maintenance. In mathematical language,
this is represented below:</p>
<p><span class="math display">\[ c_{ij} = \sum_{t=1}^{j-1}{M_{t-1}}\:\:
if\: j &gt; i \:\: otherwise \: \infty \]</span></p>
<p>Where <code>M</code> is the maintenance matrix defined above.</p>
<p>We also know our objective is to minimize the total cost, which
equates to <code>maintanence cost</code> +
<code>cost to purchase a new car</code> -
<code>trade in value</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Nodes dataframe</span></span>
<span><span class='va'>nodes</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>Year <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>"Year %s"</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>6</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>                   Color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"green"</span>, <span class='st'>"gold"</span>, <span class='st'>"gold"</span>, <span class='st'>"gold"</span>, <span class='st'>"gold"</span>, <span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>n</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>nodes</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Edges list</span></span>
<span><span class='va'>edges</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>from<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>, to<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>, cost<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>, color<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Cost matrix</span></span>
<span><span class='va'>C</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>n</span>, <span class='va'>n</span><span class='op'>)</span></span>
<span><span class='va'>BIG_M</span> <span class='op'>&lt;-</span> <span class='fl'>1000000</span></span>
<span><span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>n</span><span class='op'>)</span><span class='op'>{</span></span>
<span>  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>j</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>n</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='kw'>if</span><span class='op'>(</span><span class='va'>j</span> <span class='op'>&gt;</span> <span class='va'>i</span><span class='op'>)</span><span class='op'>{</span></span>
<span>      </span>
<span>      <span class='co'># Cost of maintenance</span></span>
<span>      <span class='va'>maintenance_cost</span> <span class='op'>&lt;-</span> <span class='va'>M_vec</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='op'>(</span><span class='va'>j</span><span class='op'>-</span><span class='va'>i</span><span class='op'>)</span><span class='op'>]</span></span>
<span>      <span class='va'>maintenance_cost_total</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>maintenance_cost</span><span class='op'>)</span></span>
<span></span>
<span>      <span class='co'># Cost of new car</span></span>
<span>      <span class='va'>new_car_cost</span> <span class='op'>=</span> <span class='va'>NEW_CAR_COST</span></span>
<span>      </span>
<span>      <span class='co'># Trade-in value</span></span>
<span>      <span class='va'>trade_in_revenue</span> <span class='op'>&lt;-</span> <span class='va'>T_vec</span><span class='op'>[</span><span class='va'>j</span><span class='op'>-</span><span class='va'>i</span><span class='op'>]</span></span>
<span></span>
<span>      <span class='co'># Total cost for decision to buy car on year i and sell it on year j</span></span>
<span>      <span class='va'>total_cost_for_decision_i_to_j</span> <span class='op'>&lt;-</span> <span class='va'>new_car_cost</span> <span class='op'>+</span> <span class='va'>maintenance_cost_total</span> <span class='op'>-</span> <span class='va'>trade_in_revenue</span></span>
<span></span>
<span>      <span class='co'># Save the value into cost matrix</span></span>
<span>      <span class='va'>C</span><span class='op'>[</span><span class='va'>i</span>,<span class='va'>j</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>total_cost_for_decision_i_to_j</span></span>
<span>      <span class='va'>edges</span><span class='op'>$</span><span class='va'>from</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/append.html'>append</a></span><span class='op'>(</span><span class='va'>edges</span><span class='op'>$</span><span class='va'>from</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Year"</span>, <span class='va'>i</span><span class='op'>)</span><span class='op'>)</span></span>
<span>      <span class='va'>edges</span><span class='op'>$</span><span class='va'>to</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/append.html'>append</a></span><span class='op'>(</span><span class='va'>edges</span><span class='op'>$</span><span class='va'>to</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Year"</span>, <span class='va'>j</span><span class='op'>)</span><span class='op'>)</span></span>
<span>      <span class='va'>edges</span><span class='op'>$</span><span class='va'>cost</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/append.html'>append</a></span><span class='op'>(</span><span class='va'>edges</span><span class='op'>$</span><span class='va'>cost</span>, <span class='va'>total_cost_for_decision_i_to_j</span><span class='op'>)</span></span>
<span>      <span class='va'>edges</span><span class='op'>$</span><span class='va'>color</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/append.html'>append</a></span><span class='op'>(</span><span class='va'>edges</span><span class='op'>$</span><span class='va'>color</span>, <span class='st'>"grey"</span><span class='op'>)</span></span>
<span>    <span class='op'>}</span></span>
<span>    <span class='kw'>else</span><span class='op'>{</span></span>
<span>      </span>
<span>      <span class='co'># Big M otherwise to make edge infeasible</span></span>
<span>      <span class='va'>C</span><span class='op'>[</span><span class='va'>i</span>,<span class='va'>j</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>BIG_M</span></span>
<span>    <span class='op'>}</span></span>
<span>  <span class='op'>}</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='co'># Edges dataframe</span></span>
<span><span class='va'>edges</span> <span class='op'>&lt;-</span> <span class='va'>edges</span> <span class='op'>%&gt;%</span> <span class='va'>as.data.frame</span></span>
<span></span>
<span><span class='va'>nodes</span></span></code></pre>
</div>
<pre><code>    Year Color
1 Year 1 green
2 Year 2  gold
3 Year 3  gold
4 Year 4  gold
5 Year 5  gold
6 Year 6   red</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>edges</span></span></code></pre>
</div>
<pre><code>     from     to  cost color
1  Year 1 Year 2  7000  grey
2  Year 1 Year 3 12000  grey
3  Year 1 Year 4 21000  grey
4  Year 1 Year 5 31000  grey
5  Year 1 Year 6 44000  grey
6  Year 2 Year 3  7000  grey
7  Year 2 Year 4 12000  grey
8  Year 2 Year 5 21000  grey
9  Year 2 Year 6 31000  grey
10 Year 3 Year 4  7000  grey
11 Year 3 Year 5 12000  grey
12 Year 3 Year 6 21000  grey
13 Year 4 Year 5  7000  grey
14 Year 4 Year 6 12000  grey
15 Year 5 Year 6  7000  grey</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>C</span></span></code></pre>
</div>
<pre><code>      [,1]  [,2]    [,3]    [,4]    [,5]    [,6]
[1,] 1e+06 7e+03   12000   21000   31000   44000
[2,] 1e+06 1e+06    7000   12000   21000   31000
[3,] 1e+06 1e+06 1000000    7000   12000   21000
[4,] 1e+06 1e+06 1000000 1000000    7000   12000
[5,] 1e+06 1e+06 1000000 1000000 1000000    7000
[6,] 1e+06 1e+06 1000000 1000000 1000000 1000000</code></pre>
</div>
<h2 id="solving-the-problem">Solving the Problem</h2>
<p>Now that we have our cost matrix, the last ingredient is to solve the
problem. That means to solve the <code>s-t shortest path</code> from
<code>Year 0</code> to <code>Year 6</code>, so we can determine what is
the cheapest investment strategy for us. For this, we will be using the
<code>igraph</code> package.</p>
<h3 id="visualizing-the-network">Visualizing the network</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>g</span> <span class='op'>&lt;-</span> <span class='fu'>igraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span>d <span class='op'>=</span> <span class='va'>edges</span>,</span>
<span>                                   directed <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>                                   vertices <span class='op'>=</span> <span class='va'>nodes</span><span class='op'>)</span></span>
<span><span class='co'># Make it a little cleaner</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>g</span>,</span>
<span>     main <span class='op'>=</span> <span class='st'>"Cost of Annual Vehicle Trade-in"</span>,</span>
<span>     edge.arrow.size<span class='op'>=</span><span class='fl'>.5</span>,</span>
<span>     vertex.color<span class='op'>=</span><span class='fu'>V</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>Color</span>,</span>
<span>     edge.color<span class='op'>=</span><span class='fu'>E</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>color</span>,</span>
<span>     edge.label <span class='op'>=</span> <span class='fu'>E</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>cost</span>,</span>
<span>     edge.width <span class='op'>=</span> <span class='fu'>E</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>cost</span><span class='op'>/</span><span class='fl'>10000</span>,</span>
<span>     vertex.size<span class='op'>=</span><span class='fl'>20</span>,</span>
<span>     vertex.frame.color<span class='op'>=</span><span class='st'>"gray"</span>,</span>
<span>     vertex.label.color<span class='op'>=</span><span class='st'>"black"</span>,</span>
<span>     vertex.label.cex<span class='op'>=</span><span class='fl'>0.8</span>,</span>
<span>     vertex.label.dist<span class='op'>=</span><span class='fl'>2</span>, layout <span class='op'>=</span> <span class='va'>layout_as_star</span>,</span>
<span>     edge.curved<span class='op'>=</span><span class='fl'>0.2</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="shortest-path-optimization-in-r_files/figure-html5/viz_network-1.png" width="624" /></p>
</div>
<h3 id="shortest-path-solution">Shortest Path Solution</h3>
<p>So once we perform the <code>Dijkstra's Shortest Path</code>
algorithm on the network we obtain a solution in matrix form. This
solution tells us the best possible cost for our car decision from
<code>Year 1</code> to <code>Year 6</code> will be at
<strong>$31,000</strong>.</p>
<p>What this does not show us is what path was chosen to obtain that
value.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Get the shortest paht cost matrix</span></span>
<span><span class='va'>s_paths_cost</span> <span class='op'>&lt;-</span> <span class='fu'>igraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/distances.html'>shortest.paths</a></span><span class='op'>(</span>graph <span class='op'>=</span> <span class='va'>g</span>, v <span class='op'>=</span> <span class='fu'>V</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span>, weights <span class='op'>=</span> <span class='fu'>E</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>cost</span>, algorithm <span class='op'>=</span> <span class='st'>"dijkstra"</span><span class='op'>)</span></span>
<span><span class='va'>s_paths_cost</span></span></code></pre>
</div>
<pre><code>       Year 1 Year 2 Year 3 Year 4 Year 5 Year 6
Year 1      0   7000  12000  19000  24000  31000
Year 2   7000      0   7000  12000  19000  24000
Year 3  12000   7000      0   7000  12000  19000
Year 4  19000  12000   7000      0   7000  12000
Year 5  24000  19000  12000   7000      0   7000
Year 6  31000  24000  19000  12000   7000      0</code></pre>
</div>
<h3 id="shortest-path-analysis">Shortest Path Analysis</h3>
<p>The optimal selection is the following sequence:</p>
<ul>
<li>Buy a new car in <code>Year 1</code> keep the car for a year, then
sell on <code>Year 2</code>.</li>
<li>Buy another car in <code>Year 2</code>, but keep for two years and
sell on <code>Year 4</code>.</li>
<li>Finally, buy a car on <code>Year 4</code>, keep for two years and
sell on <code>Year 6</code>.</li>
</ul>
<p>Do these numbers add up? Let’s check. 7000 + 12000 + 12000 == 31000
is TRUE.</p>
<p>So our least cost strategy can be no less than <code>$31000</code>
over the next 6 years. With the current cost structure, means to keep
the car for a year or two, then pitch it because the trade-off between
maintenance accumulation and depreciation start to mutually deter from a
least cost decision.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Get all path distances solution vertex path</span></span>
<span><span class='va'>s.paths</span> <span class='op'>&lt;-</span> <span class='fu'>igraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/distances.html'>shortest_paths</a></span><span class='op'>(</span>graph <span class='op'>=</span> <span class='va'>g</span>,</span>
<span>                                  from <span class='op'>=</span> <span class='st'>"Year 1"</span>,</span>
<span>                                  output <span class='op'>=</span> <span class='st'>"vpath"</span>,</span>
<span>                                  weights <span class='op'>=</span> <span class='fu'>E</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>cost</span>, </span>
<span>                                  to <span class='op'>=</span> <span class='st'>"Year 6"</span><span class='op'>)</span></span>
<span>                                  <span class='co'># v = V(g), </span></span>
<span>                                  <span class='co'># to = V(g), </span></span>
<span>                                  <span class='co'># weights = E(g)$cost)</span></span>
<span></span>
<span><span class='co'># Update colors from vertex path found</span></span>
<span><span class='va'>s.paths</span><span class='op'>$</span><span class='va'>vpath</span></span></code></pre>
</div>
<pre><code>[[1]]
+ 4/6 vertices, named, from 1e62aed:
[1] Year 1 Year 2 Year 4 Year 6</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>E</span><span class='op'>(</span><span class='va'>g</span>, path <span class='op'>=</span> <span class='va'>s.paths</span><span class='op'>$</span><span class='va'>vpath</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span><span class='op'>$</span><span class='va'>color</span> <span class='op'>&lt;-</span> <span class='st'>"red"</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>g</span>,</span>
<span>     main <span class='op'>=</span> <span class='st'>"Least Cost Vehicle Trade-in Policy"</span>,</span>
<span>     edge.arrow.size<span class='op'>=</span><span class='fl'>.5</span>,</span>
<span>     vertex.color<span class='op'>=</span><span class='fu'>V</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>Color</span>,</span>
<span>     edge.color<span class='op'>=</span><span class='fu'>E</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>color</span>,</span>
<span>     edge.label <span class='op'>=</span> <span class='fu'>E</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>cost</span>,</span>
<span>     edge.width <span class='op'>=</span> <span class='fu'>E</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>cost</span><span class='op'>/</span><span class='fl'>10000</span>,</span>
<span>     vertex.size<span class='op'>=</span><span class='fl'>20</span>,</span>
<span>     vertex.frame.color<span class='op'>=</span><span class='st'>"gray"</span>,</span>
<span>     vertex.label.color<span class='op'>=</span><span class='st'>"black"</span>,</span>
<span>     vertex.label.cex<span class='op'>=</span><span class='fl'>0.8</span>,</span>
<span>     vertex.label.dist<span class='op'>=</span><span class='fl'>2</span>, layout <span class='op'>=</span> <span class='va'>layout_as_star</span>,</span>
<span>     edge.curved<span class='op'>=</span><span class='fl'>0.2</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="shortest-path-optimization-in-r_files/figure-html5/final_plot-1.png" width="624" /></p>
</div>
<p>This plot doesn’t look too great! Let’s try to spruce it up a bit
using <code>visNetwork</code>, a common package in R that leverages the
<code>vis.js</code> framework, which can be found <a
href="https://visjs.org/">here</a>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>V</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>label</span> <span class='op'>=</span> <span class='va'>nodes</span><span class='op'>$</span><span class='va'>Year</span></span>
<span><span class='fu'>V</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>shape</span> <span class='op'>=</span> <span class='st'>"circle"</span></span>
<span><span class='fu'>E</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>width</span> <span class='op'>=</span> <span class='va'>edges</span><span class='op'>$</span><span class='va'>cost</span><span class='op'>/</span><span class='fl'>10000</span></span>
<span><span class='fu'>E</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>weight</span> <span class='op'>=</span> <span class='va'>edges</span><span class='op'>$</span><span class='va'>cost</span><span class='op'>/</span><span class='fl'>10000</span></span>
<span><span class='fu'>E</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>label</span> <span class='op'>=</span> <span class='va'>edges</span><span class='op'>$</span><span class='va'>cost</span> <span class='op'>%&gt;%</span> <span class='va'>as.character</span></span>
<span></span>
<span><span class='fu'>visIgraph</span><span class='op'>(</span>igraph <span class='op'>=</span> <span class='va'>g</span><span class='op'>)</span></span></code></pre>
</div>
<div id="htmlwidget-a2cbc9a02298c8888b7b" style="width:624px;height:384px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-a2cbc9a02298c8888b7b">{"x":{"nodes":{"id":["Year 1","Year 2","Year 3","Year 4","Year 5","Year 6"],"Color":["green","gold","gold","gold","gold","red"],"label":["Year 1","Year 2","Year 3","Year 4","Year 5","Year 6"],"shape":["circle","circle","circle","circle","circle","circle"],"x":[-0.382103555207097,-0.623932892789642,-1,1,0.609652821917467,0.38337718300087],"y":[1,-0.866133240117559,0.140420864666098,-0.153379238099499,0.858893820152528,-1]},"edges":{"from":["Year 1","Year 1","Year 1","Year 1","Year 1","Year 2","Year 2","Year 2","Year 2","Year 3","Year 3","Year 3","Year 4","Year 4","Year 5"],"to":["Year 2","Year 3","Year 4","Year 5","Year 6","Year 3","Year 4","Year 5","Year 6","Year 4","Year 5","Year 6","Year 5","Year 6","Year 6"],"cost":[7000,12000,21000,31000,44000,7000,12000,21000,31000,7000,12000,21000,7000,12000,7000],"color":["red","grey","grey","grey","grey","grey","red","grey","grey","grey","grey","grey","grey","red","grey"],"width":[0.7,1.2,2.1,3.1,4.4,0.7,1.2,2.1,3.1,0.7,1.2,2.1,0.7,1.2,0.7],"weight":[0.7,1.2,2.1,3.1,4.4,0.7,1.2,2.1,3.1,0.7,1.2,2.1,0.7,1.2,0.7],"label":["7000","12000","21000","31000","44000","7000","12000","21000","31000","7000","12000","21000","7000","12000","7000"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false,"arrows":"to"},"physics":{"stabilization":false}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"}},"evals":[],"jsHooks":[]}</script>
</div>
<h1 id="references">References</h1>
<p>Example taken from the following sources:</p>
<p><cite>Winston., Wayne. Operations Research, Applications and
Algorithms 4th Edition.</cite></p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
